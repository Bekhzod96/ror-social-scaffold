<section class="users-section">
  <ul class="users-list">
    <table>
      <tr><td>Name</td><td>Friendship status</td><td>More..</td></tr>
    <% @users.each do |user| %>
      <% if current_user.id != user.id  %>
        <li>
          <tr><td>
            <%= user.name %>
          </td><td>
            <% unless current_user.friendships.find_by(friend_id:user.id) or current_user.inverse_friendships.find_by(user_id: user.id)   %>
            <%= link_to 'Add friend', add_friend_path(:id => user.id) %>
             <% end %>

            <% if friendship = current_user.inverted_pending_friendships.find_by(user_id: user.id) %>
              <span class="accept">|<%= link_to ' Accept ', accepts_friend_path(:id => user.id) %> |</span>
              <span class="reject">|<%= link_to ' Reject ', reject_friend_path(:id => friendship.id) %> |</span>
            <% end %>

            <% if  current_user.confirmed_friendships.find_by(friend_id: user.id) or current_user.inverted_confirmed_friendships.find_by(user_id: user.id)%>
              <span>Friends</span>
          <% elsif  current_user.pending_friendships.find_by(friend_id: user.id)%>
              <span>Pending Friendship</span>

            <% end %>

          </td><td>
            <span class="profile-link">
              <%= link_to 'See Profile',  user_path(user), class: 'profile-link' %>
            </span>
          </td></tr>         
        </li>
      <% end %>
    <% end %>
  </table>
  </ul>
</section>
